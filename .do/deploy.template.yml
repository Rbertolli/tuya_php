# Nome do aplicativo
name: tuya_php

# Definição do ambiente de build
env: php
php_version: "8.1" # Adicionado a versão do PHP

# Serviços (web)
services:
  - name: web
    http_port: 8080  # A porta padrão para apps na DigitalOcean App Platform
    envs:
      - key: APP_ENV
        value: production
    source_dir: /
    routes:
      - path: /
    build_command: "composer install --no-dev --optimize-autoloader" # Movido para dentro do serviço
    run_command: "php -S 0.0.0.0:${PORT}" # Movido para dentro do serviço

# Funções (Serverless)
functions:
  - name: tuya-login
    runtime: php
    php_version: "8.1" # Adicionado a versão do PHP
    source_dir: functions/tuya
    entrypoint: login.php
    routes:
      - path: /tuya-login
  - name: tuya-smart-lock
    runtime: php
    php_version: "8.1" # Adicionado a versão do PHP
    source_dir: functions/tuya
    entrypoint: smart_lock.php
    routes:
      - path: /tuya-smart-lock