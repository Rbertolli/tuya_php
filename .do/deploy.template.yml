name: tuya_php_app
alerts:
  - rule: DEPLOYMENT_FAILED
  - rule: DOMAIN_FAILED
functions:
  - github:
      branch: main
      deploy_on_push: true
      repo: rbertolli/tuya
    name: tuya-login
    routes:
      - path: /tuya-login
    source_dir: packages/tuya
    entrypoint: login.php
  - github:
      branch: main # ou a branch que vocÃª usa
      deploy_on_push: true
      repo: rbertolli/tuya
    name: tuya-smart-lock
    routes:
      - path: /tuya-smart-lock
    source_dir: packages/tuya
    entrypoint: smart_lock.php
services:
  - name: web
    runtime: php
    php_version: "8.1"
    http_port: 8080
    envs:
      - key: APP_ENV
        value: production
    source_dir: /
    routes:
      - path: /
    build_command: "composer install --no-dev --optimize-autoloader"
    run_command: "php -S 0.0.0.0:${PORT}"